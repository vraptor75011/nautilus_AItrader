# DeepSeek AI Strategy Configuration for NautilusTrader

strategy:
  name: "DeepSeekAIStrategy"
  instrument_id: "BTCUSDT-PERP.BINANCE"

  # Bar configuration
  bar_type: "BTCUSDT-PERP.BINANCE-15-MINUTE-LAST-EXTERNAL"  # Production: 15-minute bars

  # Capital and leverage
  equity: 400  # USDT (实际账户余额)
  leverage: 10

  # Position sizing
  position_management:
    base_usdt_amount: 100  # Base position size (meets Binance $100 minimum notional)
    high_confidence_multiplier: 1.5
    medium_confidence_multiplier: 1.0
    low_confidence_multiplier: 0.5
    max_position_ratio: 0.30  # Max 30% of equity (120 USDT max with 400 equity)
    trend_strength_multiplier: 1.2
    min_trade_amount: 0.001  # Minimum BTC amount

  # Technical indicators parameters - Production: Standard periods for 15-minute timeframe
  indicators:
    sma_periods: [5, 20, 50]  # Standard SMA periods
    ema_periods: [12, 26]     # Standard EMA periods for MACD
    rsi_period: 14            # Standard RSI period
    macd_fast: 12             # Standard MACD fast period
    macd_slow: 26             # Standard MACD slow period
    macd_signal: 9            # Standard MACD signal period
    bollinger_period: 20      # Standard Bollinger Band period
    bollinger_std: 2.0
    volume_ma_period: 20      # Standard volume MA period
    support_resistance_lookback: 20  # Standard lookback for S/R levels

  # AI configuration
  deepseek:
    model: "deepseek-chat"
    temperature: 0.1
    max_retries: 2
    base_url: "https://api.deepseek.com"

  # Sentiment data
  sentiment:
    enabled: true
    provider: "cryptoracle"
    update_interval_minutes: 15
    lookback_hours: 4
    weight: 0.30  # 30% weight in decision making

  # Risk management
  risk:
    min_confidence_to_trade: "MEDIUM"  # LOW, MEDIUM, HIGH
    allow_reversals: true
    require_high_confidence_for_reversal: false  # Set to true for safer trading
    max_consecutive_same_signal: 5
    rsi_extreme_threshold_upper: 75
    rsi_extreme_threshold_lower: 25
    rsi_extreme_multiplier: 0.7
    
    # Stop Loss & Take Profit (自动止损止盈)
    enable_auto_sl_tp: true  # 启用自动止损止盈
    sl_use_support_resistance: true  # 使用支撑阻力位作为止损
    sl_buffer_pct: 0.001  # 止损缓冲 (0.1% 在支撑/阻力位之外)
    tp_high_confidence_pct: 0.03  # 高信心止盈: 3%
    tp_medium_confidence_pct: 0.02  # 中等信心止盈: 2%
    tp_low_confidence_pct: 0.01  # 低信心止盈: 1%
    
    # OCO (One-Cancels-the-Other) Management
    enable_oco: true  # 启用 OCO 自动取消机制
    oco_redis_host: "localhost"  # Redis 服务器地址
    oco_redis_port: 6379  # Redis 端口
    oco_redis_db: 0  # Redis 数据库编号
    oco_redis_password: null  # Redis 密码 (如果需要)
    oco_group_ttl_hours: 24  # OCO 组过期时间（小时）
    
    # Trailing Stop Loss (移动止损)
    enable_trailing_stop: true  # 启用移动止损
    trailing_activation_pct: 0.01  # 激活阈值: 盈利 1% 后启动移动止损
    trailing_distance_pct: 0.005  # 跟踪距离: 距离当前价 0.5%
    trailing_update_threshold_pct: 0.002  # 更新阈值: 价格移动 0.2% 才更新止损
    
    # Partial Take Profit (部分止盈)
    enable_partial_tp: true  # 启用部分止盈
    partial_tp_levels:  # 止盈级别配置 (百分比, 仓位比例)
      - {profit_pct: 0.02, position_pct: 0.5}  # 盈利2%时平50%仓位
      - {profit_pct: 0.04, position_pct: 0.5}  # 盈利4%时平剩余50%仓位

  # Telegram Notifications (Telegram 通知)
  telegram:
    enabled: true  # 启用 Telegram 通知 (配置后设为 true)
    bot_token: ""  # Bot Token (从 .env 读取 TELEGRAM_BOT_TOKEN)
    chat_id: ""    # Chat ID (从 .env 读取 TELEGRAM_CHAT_ID)
    
    # 通知类型控制
    notify_signals: true      # 通知交易信号
    notify_fills: true        # 通知订单成交
    notify_positions: true    # 通知持仓变化
    notify_errors: true       # 通知错误

  # Execution
  execution:
    order_type: "MARKET"
    time_in_force: "GTC"
    reduce_only_for_closes: true
    position_adjustment_threshold: 0.001  # Min 0.001 BTC difference to adjust

  # Timing
  timer_interval_sec: 900  # 15 minutes for production (reduced API costs and avoid overtrading)

# Logging configuration
logging:
  log_level: "INFO"
  log_to_file: true
  log_file: "logs/deepseek_strategy.log"
  log_signals: true
  log_positions: true
  log_ai_responses: true
